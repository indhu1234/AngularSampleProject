/*!
 * domo.js v3.0.6
 * Optional utility library for Custom Apps
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.domo=t():e.domo=t()}(window,(function(){return function(e){var t={};function o(r){if(t[r])return t[r].exports;var n=t[r]={i:r,l:!1,exports:{}};return e[r].call(n.exports,n,n.exports,o),n.l=!0,n.exports}return o.m=e,o.c=t,o.d=function(e,t,r){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(r,n,function(t){return e[t]}.bind(null,n));return r},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=1)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(2);t.RequestMethods=r.RequestMethods;var n=o(3);t.DataFormats=n.DataFormats},function(e,t,o){"use strict";var r=o(0),n=o(4),a=function(){function e(){}return e.post=function(e,t,o){return s(r.RequestMethods.POST,e,o,!0,t)},e.put=function(e,t,o){return s(r.RequestMethods.PUT,e,o,!0,t)},e.get=function(e,t){return s(r.RequestMethods.GET,e,t)},e.delete=function(e,t){return s(r.RequestMethods.DELETE,e,t)},e.getAll=function(t,o){return Promise.all(t.map((function(t){return e.get(t,o)})))},e.onDataUpdate=function(e){window.addEventListener("message",(function(t){if(u(t.origin)&&"string"==typeof t.data&&t.data.length>0)try{var o=JSON.parse(t.data);if(!o.hasOwnProperty("alias"))return;var r=o.alias,n=JSON.stringify({event:"ack",alias:r});t.source instanceof Window&&t.source.postMessage(n,t.origin),e(r)}catch(e){console.warn("There was an error in onDataUpdate! It may be that our event listener caught a message from another source and tried to parse it, so your update still may have worked. If you would like more info, here is the error: \n",e)}}))},e.navigate=function(e,t){var o=JSON.stringify({event:"navigate",url:e,isNewWindow:t});window.parent.postMessage(o,"*")},e.filterContainer=function(e,t,o,r){var n=window.navigator.userAgent.toLowerCase(),a=/safari/.test(n),s=/iphone|ipod|ipad/.test(n),i=JSON.stringify({event:"filter",filter:{columnName:e,operator:t,values:o,dataType:r}});s&&!a?window.webkit.messageHandlers.domofilter.postMessage({column:e,operand:t,values:o,dataType:r}):window.parent.postMessage(i,"*")},e.env=c(),e.__util={isVerifiedOrigin:u,getQueryParams:c,setFormatHeaders:f,isSuccess:i},e}();function s(e,t,o,n,a){return o=o||{},new Promise((function(s,u){var c=new XMLHttpRequest;if(n?c.open(e,t,n):c.open(e,t),f(c,t,o),function(e,t){t.contentType?"multipart"!==t.contentType&&e.setRequestHeader("Content-Type",t.contentType):e.setRequestHeader("Content-Type",r.DataFormats.JSON)}(c,o),function(e,t){void 0!==t.responseType&&(e.responseType=t.responseType)}(c,o),c.onload=function(){var e;if(i(c.status)){!["csv","excel"].includes(o.format)&&c.response||s(c.response),"blob"===o.responseType&&s(new Blob([c.response],{type:c.getResponseHeader("content-type")}));var t=c.response;try{e=JSON.parse(t)}catch(e){return void u(Error("Invalid JSON response"))}s(e)}else u(Error(c.statusText))},c.onerror=function(){u(Error("Network Error"))},a)if(o.contentType&&o.contentType!==r.DataFormats.JSON)c.send(a);else{var p=JSON.stringify(a);c.send(p)}else c.send()}))}function i(e){return e>=200&&e<300}function u(e){var t=e.match("^https?://([^/]+[.])?(domo|domotech|domorig).(com|io)?(/.*)?$"),o=e.match("(.*).(domoapps).(.*)");return!!t&&!o}function c(){var e=location.search.substr(1),t={};return e.split("&").forEach((function(e){var o=e.split("=");t[o[0]]=decodeURIComponent(o[1])})),t}function f(e,t,o){if(-1!==t.indexOf("data/v1")){var a=void 0!==o.format?n.domoFormatToRequestFormat(o.format):r.DataFormats.DEFAULT;e.setRequestHeader("Accept",a)}}e.exports=a},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.get="GET",e.GET="GET",e.post="POST",e.POST="POST",e.put="PUT",e.PUT="PUT",e.delete="DELETE",e.DELETE="DELETE"}(t.RequestMethods||(t.RequestMethods={}))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.DEFAULT="application/array-of-objects",e.ARRAY_OF_OBJECTS="application/array-of-objects",e.JSON="application/json",e.CSV="text/csv",e.EXCEL="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",e.PLAIN="text/plain"}(t.DataFormats||(t.DataFormats={}))},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(0);t.domoFormatToRequestFormat=function(e){switch(e){case"array-of-objects":return r.DataFormats.ARRAY_OF_OBJECTS;case"array-of-arrays":return r.DataFormats.JSON;case"excel":return r.DataFormats.EXCEL;case"csv":return r.DataFormats.CSV;default:return r.DataFormats.DEFAULT}}}])}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9kb21vL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly9kb21vL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL2RvbW8vLi9zcmMvbW9kZWxzL2luZGV4LnRzIiwid2VicGFjazovL2RvbW8vLi9zcmMvZG9tby50cyIsIndlYnBhY2s6Ly9kb21vLy4vc3JjL21vZGVscy9lbnVtcy9yZXF1ZXN0LW1ldGhvZHMudHMiLCJ3ZWJwYWNrOi8vZG9tby8uL3NyYy9tb2RlbHMvZW51bXMvZGF0YS1mb3JtYXRzLnRzIiwid2VicGFjazovL2RvbW8vLi9zcmMvdXRpbHMvZGF0YS1oZWxwZXJzLnRzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsIndpbmRvdyIsImluc3RhbGxlZE1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpIiwibCIsIm1vZHVsZXMiLCJjYWxsIiwibSIsImMiLCJkIiwibmFtZSIsImdldHRlciIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsInQiLCJtb2RlIiwiX19lc01vZHVsZSIsIm5zIiwiY3JlYXRlIiwia2V5IiwiYmluZCIsIm4iLCJvYmplY3QiLCJwcm9wZXJ0eSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwicCIsInMiLCJSZXF1ZXN0TWV0aG9kcyIsIkRhdGFGb3JtYXRzIiwicG9zdCIsInVybCIsImJvZHkiLCJvcHRpb25zIiwiZG9tb0h0dHAiLCJQT1NUIiwicHV0IiwiUFVUIiwiR0VUIiwiZGVsZXRlIiwiREVMRVRFIiwiZ2V0QWxsIiwidXJscyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJkb21vIiwib25EYXRhVXBkYXRlIiwiY2IiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJpc1ZlcmlmaWVkT3JpZ2luIiwib3JpZ2luIiwiZGF0YSIsImxlbmd0aCIsIm1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJhbGlhcyIsImFjayIsInN0cmluZ2lmeSIsInNvdXJjZSIsIldpbmRvdyIsInBvc3RNZXNzYWdlIiwiZXJyIiwiY29uc29sZSIsIndhcm4iLCJuYXZpZ2F0ZSIsImlzTmV3V2luZG93IiwicGFyZW50IiwiZmlsdGVyQ29udGFpbmVyIiwiY29sdW1uIiwib3BlcmF0b3IiLCJ2YWx1ZXMiLCJkYXRhVHlwZSIsInVzZXJBZ2VudCIsIm5hdmlnYXRvciIsInRvTG93ZXJDYXNlIiwic2FmYXJpIiwidGVzdCIsImlvcyIsImZpbHRlciIsImNvbHVtbk5hbWUiLCJ3ZWJraXQiLCJtZXNzYWdlSGFuZGxlcnMiLCJkb21vZmlsdGVyIiwib3BlcmFuZCIsImVudiIsImdldFF1ZXJ5UGFyYW1zIiwiX191dGlsIiwic2V0Rm9ybWF0SGVhZGVycyIsImlzU3VjY2VzcyIsIm1ldGhvZCIsImFzeW5jIiwicmVzb2x2ZSIsInJlamVjdCIsInJlcSIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsImNvbnRlbnRUeXBlIiwic2V0UmVxdWVzdEhlYWRlciIsInNldENvbnRlbnRIZWFkZXJzIiwidW5kZWZpbmVkIiwicmVzcG9uc2VUeXBlIiwic2V0UmVzcG9uc2VUeXBlIiwib25sb2FkIiwic3RhdHVzIiwiaW5jbHVkZXMiLCJmb3JtYXQiLCJyZXNwb25zZSIsIkJsb2IiLCJ0eXBlIiwiZ2V0UmVzcG9uc2VIZWFkZXIiLCJyZXNwb25zZVN0ciIsImV4IiwiRXJyb3IiLCJzdGF0dXNUZXh0Iiwib25lcnJvciIsInNlbmQiLCJqc29uIiwid2hpdGVsaXN0ZWQiLCJtYXRjaCIsImJsYWNrbGlzdGVkIiwicXVlcnkiLCJsb2NhdGlvbiIsInNlYXJjaCIsInN1YnN0ciIsInJlc3VsdCIsInNwbGl0IiwiZm9yRWFjaCIsInBhcnQiLCJpdGVtIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiaW5kZXhPZiIsInJlcXVlc3RGb3JtYXQiLCJkb21vRm9ybWF0VG9SZXF1ZXN0Rm9ybWF0IiwiQVJSQVlfT0ZfT0JKRUNUUyIsIkVYQ0VMIiwiQ1NWIiwiREVGQVVMVCJdLCJtYXBwaW5ncyI6Ijs7OztDQUFBLFNBQTJDQSxFQUFNQyxHQUMxQixpQkFBWkMsU0FBMEMsaUJBQVhDLE9BQ3hDQSxPQUFPRCxRQUFVRCxJQUNRLG1CQUFYRyxRQUF5QkEsT0FBT0MsSUFDOUNELE9BQU8sR0FBSUgsR0FDZSxpQkFBWkMsUUFDZEEsUUFBYyxLQUFJRCxJQUVsQkQsRUFBVyxLQUFJQyxJQVJqQixDQVNHSyxRQUFRLFdBQ1gsTyxZQ1RFLElBQUlDLEVBQW1CLEdBR3ZCLFNBQVNDLEVBQW9CQyxHQUc1QixHQUFHRixFQUFpQkUsR0FDbkIsT0FBT0YsRUFBaUJFLEdBQVVQLFFBR25DLElBQUlDLEVBQVNJLEVBQWlCRSxHQUFZLENBQ3pDQyxFQUFHRCxFQUNIRSxHQUFHLEVBQ0hULFFBQVMsSUFVVixPQU5BVSxFQUFRSCxHQUFVSSxLQUFLVixFQUFPRCxRQUFTQyxFQUFRQSxFQUFPRCxRQUFTTSxHQUcvREwsRUFBT1EsR0FBSSxFQUdKUixFQUFPRCxRQTBEZixPQXJEQU0sRUFBb0JNLEVBQUlGLEVBR3hCSixFQUFvQk8sRUFBSVIsRUFHeEJDLEVBQW9CUSxFQUFJLFNBQVNkLEVBQVNlLEVBQU1DLEdBQzNDVixFQUFvQlcsRUFBRWpCLEVBQVNlLElBQ2xDRyxPQUFPQyxlQUFlbkIsRUFBU2UsRUFBTSxDQUFFSyxZQUFZLEVBQU1DLElBQUtMLEtBS2hFVixFQUFvQmdCLEVBQUksU0FBU3RCLEdBQ1gsb0JBQVh1QixRQUEwQkEsT0FBT0MsYUFDMUNOLE9BQU9DLGVBQWVuQixFQUFTdUIsT0FBT0MsWUFBYSxDQUFFQyxNQUFPLFdBRTdEUCxPQUFPQyxlQUFlbkIsRUFBUyxhQUFjLENBQUV5QixPQUFPLEtBUXZEbkIsRUFBb0JvQixFQUFJLFNBQVNELEVBQU9FLEdBRXZDLEdBRFUsRUFBUEEsSUFBVUYsRUFBUW5CLEVBQW9CbUIsSUFD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U0FBWWxCLEdBQ1YsWUFDQSxZQUNBLGNBQ0EsY0FDQSxZQUNBLFlBQ0Esa0JBQ0Esa0JBUkYsQ0FBWSxFQUFBQSxpQkFBQSxFQUFBQSxlQUFjLE0sOEVDTzFCLFNBQVlDLEdBQ1YseUNBQ0Esa0RBQ0EsMEJBQ0EsaUJBQ0EsNEVBQ0EscUJBTkYsQ0FBWSxFQUFBQSxjQUFBLEVBQUFBLFlBQVcsTSw4RUNQdkIsV0FFQSxxQ0FBMEMrRSxHQUN4QyxPQUFRQSxHQUNOLElBQUssbUJBQ0gsT0FBTyxFQUFBL0UsWUFBWTJHLGlCQUVyQixJQUFLLGtCQUNILE9BQU8sRUFBQTNHLFlBQVkyQixLQUVyQixJQUFLLFFBQ0gsT0FBTyxFQUFBM0IsWUFBWTRHLE1BRXJCLElBQUssTUFDSCxPQUFPLEVBQUE1RyxZQUFZNkcsSUFFckIsUUFDRSxPQUFPLEVBQUE3RyxZQUFZOEciLCJmaWxlIjoiZG9tby5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcImRvbW9cIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiZG9tb1wiXSA9IGZhY3RvcnkoKTtcbn0pKHdpbmRvdywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwiZXhwb3J0IHsgUmVxdWVzdE1ldGhvZHMgfSBmcm9tICcuL2VudW1zL3JlcXVlc3QtbWV0aG9kcyc7XG5leHBvcnQgeyBEb21vRGF0YUZvcm1hdHMgfSBmcm9tICcuL2ludGVyZmFjZXMvZG9tby1kYXRhLWZvcm1hdHMnO1xuZXhwb3J0IHsgRGF0YUZvcm1hdHMgfSBmcm9tICcuL2VudW1zL2RhdGEtZm9ybWF0cyc7XG5leHBvcnQgeyBGaWx0ZXJEYXRhVHlwZXMgfSBmcm9tICcuL2ludGVyZmFjZXMvZmlsdGVyLWRhdGEtdHlwZXMnO1xuZXhwb3J0IHsgRmlsdGVyT3BlcmF0b3JzIH0gZnJvbSAnLi9pbnRlcmZhY2VzL2ZpbHRlci1vcGVyYXRvcnMnO1xuXG5leHBvcnQgeyBSZXF1ZXN0T3B0aW9ucywgT2JqZWN0UmVxdWVzdE9wdGlvbnMsIEFycmF5UmVxdWVzdE9wdGlvbnMgfSBmcm9tICcuL2ludGVyZmFjZXMvcmVxdWVzdC1vcHRpb25zJztcbmV4cG9ydCB7IFF1ZXJ5UGFyYW1zIH0gZnJvbSAnLi9pbnRlcmZhY2VzL3F1ZXJ5LXBhcmFtcyc7XG5leHBvcnQgeyBSZXF1ZXN0Qm9keSwgWE1MSHR0cFJlcXVlc3RCb2R5IH0gZnJvbSAnLi9pbnRlcmZhY2VzL3JlcXVlc3QtYm9keSc7XG5leHBvcnQgeyBSZXNwb25zZUJvZHksIE9iamVjdFJlc3BvbnNlQm9keSwgQXJyYXlSZXNwb25zZUJvZHkgfSBmcm9tICcuL2ludGVyZmFjZXMvcmVzcG9uc2UtYm9keSc7XG5leHBvcnQgeyBKc29uIH0gZnJvbSAnLi9pbnRlcmZhY2VzL2pzb24nO1xuIiwiaW1wb3J0IHtcbiAgUmVxdWVzdE1ldGhvZHMsXG4gIFJlcXVlc3RPcHRpb25zLFxuICBPYmplY3RSZXF1ZXN0T3B0aW9ucyxcbiAgQXJyYXlSZXF1ZXN0T3B0aW9ucyxcbiAgRGF0YUZvcm1hdHMsXG4gIFF1ZXJ5UGFyYW1zLFxuICBGaWx0ZXJEYXRhVHlwZXMsXG4gIEZpbHRlck9wZXJhdG9ycyxcbiAgUmVxdWVzdEJvZHksXG4gIFhNTEh0dHBSZXF1ZXN0Qm9keSxcbiAgUmVzcG9uc2VCb2R5LFxuICBPYmplY3RSZXNwb25zZUJvZHksXG4gIEFycmF5UmVzcG9uc2VCb2R5LFxufSBmcm9tICcuL21vZGVscyc7XG5pbXBvcnQgeyBkb21vRm9ybWF0VG9SZXF1ZXN0Rm9ybWF0IH0gZnJvbSAnLi91dGlscy9kYXRhLWhlbHBlcnMnO1xuXG5leHBvcnQgPSBkb21vO1xuXG5jbGFzcyBkb21vIHtcbiAgc3RhdGljIHBvc3QodXJsOiBzdHJpbmcsIGJvZHk/OiBSZXF1ZXN0Qm9keSwgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxSZXNwb25zZUJvZHk+O1xuICBzdGF0aWMgcG9zdDxUPih1cmw6IHN0cmluZywgYm9keT86IFJlcXVlc3RCb2R5LCBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnMpOiBQcm9taXNlPFQ+O1xuICBzdGF0aWMgcG9zdDxUPih1cmw6IHN0cmluZywgYm9keT86IFJlcXVlc3RCb2R5LCBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnMpOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gZG9tb0h0dHA8VD4oUmVxdWVzdE1ldGhvZHMuUE9TVCwgdXJsLCBvcHRpb25zLCB0cnVlLCBib2R5KTtcbiAgfVxuICBcbiAgc3RhdGljIHB1dCh1cmw6IHN0cmluZywgYm9keT86IFJlcXVlc3RCb2R5LCBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnMpOiBQcm9taXNlPFJlc3BvbnNlQm9keT47XG4gIHN0YXRpYyBwdXQ8VD4odXJsOiBzdHJpbmcsIGJvZHk/OiBSZXF1ZXN0Qm9keSwgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxUPjtcbiAgc3RhdGljIHB1dDxUPih1cmw6IHN0cmluZywgYm9keT86IFJlcXVlc3RCb2R5LCBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnMpOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gZG9tb0h0dHA8VD4oUmVxdWVzdE1ldGhvZHMuUFVULCB1cmwsIG9wdGlvbnMsIHRydWUsIGJvZHkpO1xuICB9XG4gIFxuICBzdGF0aWMgZ2V0KHVybDogc3RyaW5nLCBvcHRpb25zOiBPYmplY3RSZXF1ZXN0T3B0aW9ucyk6IFByb21pc2U8T2JqZWN0UmVzcG9uc2VCb2R5W10+O1xuICBzdGF0aWMgZ2V0KHVybDogc3RyaW5nLCBvcHRpb25zOiBBcnJheVJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxBcnJheVJlc3BvbnNlQm9keT47XG4gIHN0YXRpYyBnZXQodXJsOiBzdHJpbmcsIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9ucyk6IFByb21pc2U8UmVzcG9uc2VCb2R5PjtcbiAgc3RhdGljIGdldDxUPih1cmw6IHN0cmluZywgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxUPjtcbiAgc3RhdGljIGdldDxUPih1cmw6IHN0cmluZywgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxUPiB7XG4gICAgcmV0dXJuIGRvbW9IdHRwPFQ+KFJlcXVlc3RNZXRob2RzLkdFVCwgdXJsLCBvcHRpb25zKTtcbiAgfVxuICBcbiAgc3RhdGljIGRlbGV0ZSh1cmw6IHN0cmluZywgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxSZXNwb25zZUJvZHk+O1xuICBzdGF0aWMgZGVsZXRlPFQ+KHVybDogc3RyaW5nLCBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnMpOiBQcm9taXNlPFQ+O1xuICBzdGF0aWMgZGVsZXRlPFQ+KHVybDogc3RyaW5nLCBvcHRpb25zPzogUmVxdWVzdE9wdGlvbnMpOiBQcm9taXNlPFQ+IHtcbiAgICByZXR1cm4gZG9tb0h0dHA8VD4oUmVxdWVzdE1ldGhvZHMuREVMRVRFLCB1cmwsIG9wdGlvbnMpO1xuICB9XG5cbiAgc3RhdGljIGdldEFsbCh1cmxzOiBzdHJpbmdbXSwgb3B0aW9uczogT2JqZWN0UmVxdWVzdE9wdGlvbnMpOiBQcm9taXNlPE9iamVjdFJlc3BvbnNlQm9keVtdW10+O1xuICBzdGF0aWMgZ2V0QWxsKHVybHM6IHN0cmluZ1tdLCBvcHRpb25zOiBBcnJheVJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxBcnJheVJlc3BvbnNlQm9keVtdPjtcbiAgc3RhdGljIGdldEFsbCh1cmxzOiBzdHJpbmdbXSwgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxSZXNwb25zZUJvZHlbXT47XG4gIHN0YXRpYyBnZXRBbGw8VD4odXJsczogc3RyaW5nW10sIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9ucyk6IFByb21pc2U8VFtdPjtcbiAgc3RhdGljIGdldEFsbDxUPih1cmxzOiBzdHJpbmdbXSwgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKTogUHJvbWlzZTxUW10+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwodXJscy5tYXAoZnVuY3Rpb24odXJsKXtcbiAgICAgIHJldHVybiBkb21vLmdldDxUPih1cmwsIG9wdGlvbnMpO1xuICAgIH0pKTtcbiAgfTtcbiAgXG4gIC8qKlxuICAgKiBMZXQgdGhlIGRvbW9hcHAgb3B0aW9uYWxseSBoYW5kbGUgaXRzIG93biBkYXRhIHVwZGF0ZXMuXG4gICAqL1xuICBzdGF0aWMgb25EYXRhVXBkYXRlKGNiOiAoYWxpYXM6IHN0cmluZykgPT4gdm9pZCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgZnVuY3Rpb24oZXZlbnQ6IE1lc3NhZ2VFdmVudCkge1xuICAgICAgaWYgKCFpc1ZlcmlmaWVkT3JpZ2luKGV2ZW50Lm9yaWdpbikpXG4gICAgICAgIHJldHVybjtcbiAgXG4gICAgICBpZiAodHlwZW9mIGV2ZW50LmRhdGEgPT09ICdzdHJpbmcnICYmIGV2ZW50LmRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpO1xuICAgICAgICAgIGlmICghbWVzc2FnZS5oYXNPd25Qcm9wZXJ0eSgnYWxpYXMnKSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgXG4gICAgICAgICAgY29uc3QgYWxpYXMgPSBtZXNzYWdlLmFsaWFzO1xuICBcbiAgICAgICAgICAvLyBzZW5kIGFja25vd2xlZGdlbWVudCB0byBwcmV2ZW50IGF1dG9yZWZyZXNoXG4gICAgICAgICAgY29uc3QgYWNrID0gSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgZXZlbnQ6ICdhY2snLFxuICAgICAgICAgICAgYWxpYXM6IGFsaWFzLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmKGV2ZW50LnNvdXJjZSBpbnN0YW5jZW9mIFdpbmRvdykge1xuICAgICAgICAgICAgZXZlbnQuc291cmNlLnBvc3RNZXNzYWdlKGFjaywgZXZlbnQub3JpZ2luKTtcbiAgICAgICAgICB9XG4gIFxuICAgICAgICAgIC8vIGluZm9ybSBkb21vIGFwcCB3aGljaCBhbGlhcyBoYXMgYmVlbiB1cGRhdGVkXG4gICAgICAgICAgY2IoYWxpYXMpO1xuICAgICAgICB9IGNhdGNoKGVycikge1xuICAgICAgICAgIGNvbnN0IGluZm8gPSAnVGhlcmUgd2FzIGFuIGVycm9yIGluIG9uRGF0YVVwZGF0ZSEgSXQgbWF5IGJlIHRoYXQgb3VyIGV2ZW50IGxpc3RlbmVyIGNhdWdodCAnICtcbiAgICAgICAgICAgICAgICAgICAgICdhIG1lc3NhZ2UgZnJvbSBhbm90aGVyIHNvdXJjZSBhbmQgdHJpZWQgdG8gcGFyc2UgaXQsIHNvIHlvdXIgdXBkYXRlIHN0aWxsIG1heSBoYXZlIHdvcmtlZC4gJyArXG4gICAgICAgICAgICAgICAgICAgICAnSWYgeW91IHdvdWxkIGxpa2UgbW9yZSBpbmZvLCBoZXJlIGlzIHRoZSBlcnJvcjogXFxuJ1xuICAgICAgICAgIGNvbnNvbGUud2FybihpbmZvLCBlcnIpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG4gIFxuICAvKipcbiAgICogUmVxdWVzdCBhIG5hdmlnYXRpb24gY2hhbmdlXG4gICAqL1xuICBzdGF0aWMgbmF2aWdhdGUodXJsOiBzdHJpbmcsIGlzTmV3V2luZG93OiBib29sZWFuKSB7XG4gICAgY29uc3QgbWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIGV2ZW50OiAnbmF2aWdhdGUnLFxuICAgICAgdXJsOiB1cmwsXG4gICAgICBpc05ld1dpbmRvdzogaXNOZXdXaW5kb3dcbiAgICB9KTtcbiAgICB3aW5kb3cucGFyZW50LnBvc3RNZXNzYWdlKG1lc3NhZ2UsIFwiKlwiKTtcbiAgfVxuICBcbiAgc3RhdGljIGZpbHRlckNvbnRhaW5lcihjb2x1bW46IHN0cmluZywgb3BlcmF0b3I6IEZpbHRlck9wZXJhdG9ycywgdmFsdWVzOiBzdHJpbmdbXSwgZGF0YVR5cGU6ICdTVFJJTkcnKTogdm9pZDtcbiAgc3RhdGljIGZpbHRlckNvbnRhaW5lcihjb2x1bW46IHN0cmluZywgb3BlcmF0b3I6IEZpbHRlck9wZXJhdG9ycywgdmFsdWVzOiBudW1iZXJbXSwgZGF0YVR5cGU6ICdOVU1FUklDJyk6IHZvaWQ7XG4gIHN0YXRpYyBmaWx0ZXJDb250YWluZXIoY29sdW1uOiBzdHJpbmcsIG9wZXJhdG9yOiBGaWx0ZXJPcGVyYXRvcnMsIHZhbHVlczogRGF0ZVtdLCBkYXRhVHlwZTogJ0RBVEUnIHwgJ0RBVEVUSU1FJyk6IHZvaWQ7XG4gIHN0YXRpYyBmaWx0ZXJDb250YWluZXIoY29sdW1uOiBzdHJpbmcsIG9wZXJhdG9yOiBGaWx0ZXJPcGVyYXRvcnMsIHZhbHVlczogKHN0cmluZyB8IG51bWJlciB8IERhdGUpW10sIGRhdGFUeXBlOiBGaWx0ZXJEYXRhVHlwZXMpOiB2b2lkIHtcbiAgICBjb25zdCB1c2VyQWdlbnQgPSB3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLFxuICAgICAgc2FmYXJpID0gL3NhZmFyaS8udGVzdCggdXNlckFnZW50ICksXG4gICAgICBpb3MgPSAvaXBob25lfGlwb2R8aXBhZC8udGVzdCggdXNlckFnZW50ICk7XG4gIFxuICAgIGNvbnN0IG1lc3NhZ2UgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBldmVudDogJ2ZpbHRlcicsXG4gICAgICBmaWx0ZXI6IHtcbiAgICAgICAgY29sdW1uTmFtZTogY29sdW1uLFxuICAgICAgICBvcGVyYXRvcjogb3BlcmF0b3IsXG4gICAgICAgIHZhbHVlczogdmFsdWVzLFxuICAgICAgICBkYXRhVHlwZTogZGF0YVR5cGVcbiAgICAgIH1cbiAgICB9KTtcbiAgXG4gICAgaWYoaW9zICYmICFzYWZhcmkpIHtcbiAgICAgICh3aW5kb3cgYXMgYW55KS53ZWJraXQubWVzc2FnZUhhbmRsZXJzLmRvbW9maWx0ZXIucG9zdE1lc3NhZ2UoeyBjb2x1bW46IGNvbHVtbiwgb3BlcmFuZDogb3BlcmF0b3IsIHZhbHVlczogdmFsdWVzLCBkYXRhVHlwZTogZGF0YVR5cGUgfSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgd2luZG93LnBhcmVudC5wb3N0TWVzc2FnZShtZXNzYWdlLCBcIipcIik7XG4gICAgfVxuICB9XG4gIFxuICBzdGF0aWMgZW52ID0gZ2V0UXVlcnlQYXJhbXMoKTtcbiAgXG4gIHN0YXRpYyBfX3V0aWwgPSB7XG4gICAgaXNWZXJpZmllZE9yaWdpbixcbiAgICBnZXRRdWVyeVBhcmFtcyxcbiAgICBzZXRGb3JtYXRIZWFkZXJzLCBcbiAgICBpc1N1Y2Nlc3NcbiAgfVxuXG59O1xuXG5mdW5jdGlvbiBkb21vSHR0cChtZXRob2Q6IFJlcXVlc3RNZXRob2RzLCB1cmw6IHN0cmluZywgb3B0aW9uczogT2JqZWN0UmVxdWVzdE9wdGlvbnMsIGFzeW5jPzogYm9vbGVhbiwgYm9keT86IFJlcXVlc3RCb2R5KTogUHJvbWlzZTxPYmplY3RSZXNwb25zZUJvZHlbXT47XG5mdW5jdGlvbiBkb21vSHR0cChtZXRob2Q6IFJlcXVlc3RNZXRob2RzLCB1cmw6IHN0cmluZywgb3B0aW9uczogQXJyYXlSZXF1ZXN0T3B0aW9ucywgYXN5bmM/OiBib29sZWFuLCBib2R5PzogUmVxdWVzdEJvZHkpOiBQcm9taXNlPEFycmF5UmVzcG9uc2VCb2R5PjtcbmZ1bmN0aW9uIGRvbW9IdHRwKG1ldGhvZDogUmVxdWVzdE1ldGhvZHMsIHVybDogc3RyaW5nLCBvcHRpb25zOiBSZXF1ZXN0T3B0aW9ucywgYXN5bmM/OiBib29sZWFuLCBib2R5PzogUmVxdWVzdEJvZHkpOiBQcm9taXNlPFJlc3BvbnNlQm9keT47XG5mdW5jdGlvbiBkb21vSHR0cDxUPihtZXRob2Q6IFJlcXVlc3RNZXRob2RzLCB1cmw6IHN0cmluZywgb3B0aW9uczogUmVxdWVzdE9wdGlvbnMsIGFzeW5jPzogYm9vbGVhbiwgYm9keT86IFJlcXVlc3RCb2R5KTogUHJvbWlzZTxUPjtcbmZ1bmN0aW9uIGRvbW9IdHRwKG1ldGhvZDogUmVxdWVzdE1ldGhvZHMsIHVybDogc3RyaW5nLCBvcHRpb25zOiBSZXF1ZXN0T3B0aW9ucywgYXN5bmM/OiBib29sZWFuLCBib2R5PzogUmVxdWVzdEJvZHkpOiBQcm9taXNlPFJlc3BvbnNlQm9keT4ge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmU6ICh2YWx1ZT86IFJlc3BvbnNlQm9keSkgPT4gdm9pZCwgcmVqZWN0OiAocmVhc29uPzogRXJyb3IpID0+IHZvaWQpIHtcbiAgICAvLyBEbyB0aGUgdXN1YWwgWEhSIHN0dWZmXG4gICAgbGV0IHJlcTogWE1MSHR0cFJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICBpZihhc3luYykge1xuICAgICAgcmVxLm9wZW4obWV0aG9kLCB1cmwsIGFzeW5jKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICByZXEub3BlbihtZXRob2QsIHVybCk7XG4gICAgfVxuICAgIHNldEZvcm1hdEhlYWRlcnMocmVxLCB1cmwsIG9wdGlvbnMpO1xuICAgIHNldENvbnRlbnRIZWFkZXJzKHJlcSwgb3B0aW9ucyk7XG4gICAgc2V0UmVzcG9uc2VUeXBlKHJlcSwgb3B0aW9ucyk7XG5cbiAgICByZXEub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICBsZXQgZGF0YTtcbiAgICAgIC8vIFRoaXMgaXMgY2FsbGVkIGV2ZW4gb24gNDA0IGV0YyBzbyBjaGVjayB0aGUgc3RhdHVzXG4gICAgICBpZiAoaXNTdWNjZXNzKHJlcS5zdGF0dXMpKSB7XG4gICAgICAgIFxuICAgICAgICBpZiAoWydjc3YnLCAnZXhjZWwnXS5pbmNsdWRlcyhvcHRpb25zLmZvcm1hdCkgfHwgIXJlcS5yZXNwb25zZSl7XG4gICAgICAgICAgcmVzb2x2ZShyZXEucmVzcG9uc2UpO1xuICAgICAgICB9XG4gICAgICAgIGlmKG9wdGlvbnMucmVzcG9uc2VUeXBlID09PSAnYmxvYicpIHtcbiAgICAgICAgICByZXNvbHZlKG5ldyBCbG9iKFtyZXEucmVzcG9uc2VdLCB7dHlwZTogcmVxLmdldFJlc3BvbnNlSGVhZGVyKCdjb250ZW50LXR5cGUnKX0pKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCByZXNwb25zZVN0ciA9IHJlcS5yZXNwb25zZTtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyBpZighcmVzcG9uc2VTdHIpIHtcbiAgICAgICAgICAvLyAgIHJlc3BvbnNlU3RyID0gXCJ7fVwiO1xuICAgICAgICAgIC8vIH1cbiAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShyZXNwb25zZVN0cik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGV4KXtcbiAgICAgICAgICByZWplY3QoRXJyb3IoJ0ludmFsaWQgSlNPTiByZXNwb25zZScpKTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgLy8gUmVzb2x2ZSB0aGUgcHJvbWlzZSB3aXRoIHRoZSByZXNwb25zZSB0ZXh0XG4gICAgICAgIHJlc29sdmUoZGF0YSk7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgLy8gT3RoZXJ3aXNlIHJlamVjdCB3aXRoIHRoZSBzdGF0dXMgdGV4dFxuICAgICAgICAvLyB3aGljaCB3aWxsIGhvcGVmdWxseSBiZSBhIG1lYW5pbmdmdWwgZXJyb3JcbiAgICAgICAgcmVqZWN0KEVycm9yKHJlcS5zdGF0dXNUZXh0KSk7XG4gICAgICB9XG4gICAgfTtcblxuICAgIC8vIEhhbmRsZSBuZXR3b3JrIGVycm9yc1xuICAgIHJlcS5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICByZWplY3QoRXJyb3IoXCJOZXR3b3JrIEVycm9yXCIpKTtcbiAgICB9O1xuXG4gICAgLy8gTWFrZSB0aGUgcmVxdWVzdFxuICAgIGlmKGJvZHkpIHtcbiAgICAgIGlmICghb3B0aW9ucy5jb250ZW50VHlwZSB8fCBvcHRpb25zLmNvbnRlbnRUeXBlID09PSBEYXRhRm9ybWF0cy5KU09OKSB7XG4gICAgICAgIGNvbnN0IGpzb24gPSBKU09OLnN0cmluZ2lmeShib2R5KTtcbiAgICAgICAgLy8gTWFrZSB0aGUgcmVxdWVzdFxuICAgICAgICByZXEuc2VuZChqc29uKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGJvZHkgY2FuIG5vIGxvbmdlciBiZSBKU09OXG4gICAgICAgIHJlcS5zZW5kKGJvZHkgYXMgWE1MSHR0cFJlcXVlc3RCb2R5KTtcbiAgICAgIH1cbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICByZXEuc2VuZCgpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGlzU3VjY2VzcyhzdGF0dXM6IG51bWJlcikge1xuICByZXR1cm4gc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDA7XG59XG5cbmZ1bmN0aW9uIGlzVmVyaWZpZWRPcmlnaW4ob3JpZ2luOiBzdHJpbmcpIHtcbiAgY29uc3Qgd2hpdGVsaXN0ZWQgPSBvcmlnaW4ubWF0Y2goJ15odHRwcz86Ly8oW14vXStbLl0pPyhkb21vfGRvbW90ZWNofGRvbW9yaWcpXFwuKGNvbXxpbyk/KC8uKik/JCcpO1xuICBjb25zdCBibGFja2xpc3RlZCA9IG9yaWdpbi5tYXRjaCgnKC4qKVxcLihkb21vYXBwcylcXC4oLiopJyk7XG4gIHJldHVybiAhIXdoaXRlbGlzdGVkICYmICFibGFja2xpc3RlZDtcbn1cblxuZnVuY3Rpb24gZ2V0UXVlcnlQYXJhbXMoKTogUXVlcnlQYXJhbXMge1xuICBjb25zdCBxdWVyeSA9IGxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSk7XG4gIGxldCByZXN1bHQgOiB7IFtpbmRleCA6IHN0cmluZ10gOiBzdHJpbmd9ID0ge307XG4gIHF1ZXJ5LnNwbGl0KFwiJlwiKS5mb3JFYWNoKGZ1bmN0aW9uKHBhcnQpIHtcbiAgICBjb25zdCBpdGVtID0gcGFydC5zcGxpdChcIj1cIik7XG4gICAgcmVzdWx0W2l0ZW1bMF1dID0gZGVjb2RlVVJJQ29tcG9uZW50KGl0ZW1bMV0pO1xuICB9KTtcbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuZnVuY3Rpb24gc2V0Rm9ybWF0SGVhZGVycyhyZXE6IFhNTEh0dHBSZXF1ZXN0LCB1cmw6IHN0cmluZywgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKXtcbiAgaWYgKHVybC5pbmRleE9mKCdkYXRhL3YxJykgPT09IC0xICkgeyByZXR1cm47IH1cbiAgLy8gc2V0IGZvcm1hdFxuICBjb25zdCByZXF1ZXN0Rm9ybWF0OiBEYXRhRm9ybWF0cyA9IChvcHRpb25zLmZvcm1hdCAhPT0gdW5kZWZpbmVkKVxuICAgID8gKGRvbW9Gb3JtYXRUb1JlcXVlc3RGb3JtYXQob3B0aW9ucy5mb3JtYXQpKSBcbiAgICA6IChEYXRhRm9ybWF0cy5ERUZBVUxUKTtcblxuICByZXEuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgcmVxdWVzdEZvcm1hdCk7XG59XG5cbmZ1bmN0aW9uIHNldENvbnRlbnRIZWFkZXJzKHJlcTogWE1MSHR0cFJlcXVlc3QsIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9ucykge1xuICBpZiAob3B0aW9ucy5jb250ZW50VHlwZSkge1xuICAgIC8vIHNldCBjb250ZW50IHR5cGUgaWYgdXNlciBwYXNzZWQgb3B0aW9uXG4gICAgaWYob3B0aW9ucy5jb250ZW50VHlwZSAhPT0gJ211bHRpcGFydCcpe1xuICAgICAgcmVxLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsIG9wdGlvbnMuY29udGVudFR5cGUpO1xuICAgIH1cbiAgfVxuICBlbHNlIHtcbiAgICByZXEuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgRGF0YUZvcm1hdHMuSlNPTik7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2V0UmVzcG9uc2VUeXBlKHJlcTogWE1MSHR0cFJlcXVlc3QsIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9ucykge1xuICAvL3NldCByZXNwb25zZSB0eXBlIGlmIHVzZXIgcGFzc2VkIG9wdGlvblxuICBpZiAob3B0aW9ucy5yZXNwb25zZVR5cGUgIT09IHVuZGVmaW5lZCkge1xuICAgIHJlcS5yZXNwb25zZVR5cGUgPSBvcHRpb25zLnJlc3BvbnNlVHlwZTtcbiAgfVxufSIsImV4cG9ydCBlbnVtIFJlcXVlc3RNZXRob2RzIHtcbiAgZ2V0ID0gJ0dFVCcsXG4gIEdFVCA9ICdHRVQnLFxuICBwb3N0ID0gJ1BPU1QnLFxuICBQT1NUID0gJ1BPU1QnLFxuICBwdXQgPSAnUFVUJyxcbiAgUFVUID0gJ1BVVCcsXG4gIGRlbGV0ZSA9ICdERUxFVEUnLFxuICBERUxFVEUgPSAnREVMRVRFJyxcbn1cbiIsIi8qKlxuICogU3VwcG9ydGVkIGBhY2NlcHRgIGhlYWRlcnMgZm9yIGNvbnRyb2xsaW5nIHRoZSBmb3JtYXRcbiAqIG9mIHRoZSBkYXRhIHJldHVybmVkIGZyb20gRG9tby5cbiAqXG4gKiBTZWUgW2RldmVsb3Blci5kb21vLmNvbV0oaHR0cHM6Ly9kZXZlbG9wZXIuZG9tby5jb20vZG9jcy9kZXYtc3R1ZGlvLXJlZmVyZW5jZXMvZGF0YS1hcGkjRGF0YSUyMEZvcm1hdHMpXG4gKiBmb3IgbW9yZSBkZXRhaWxzLlxuICovXG5leHBvcnQgZW51bSBEYXRhRm9ybWF0cyB7XG4gIERFRkFVTFQgPSAnYXBwbGljYXRpb24vYXJyYXktb2Ytb2JqZWN0cycsXG4gIEFSUkFZX09GX09CSkVDVFMgPSAnYXBwbGljYXRpb24vYXJyYXktb2Ytb2JqZWN0cycsXG4gIEpTT04gPSAnYXBwbGljYXRpb24vanNvbicsXG4gIENTViA9ICd0ZXh0L2NzdicsXG4gIEVYQ0VMID0gJ2FwcGxpY2F0aW9uL3ZuZC5vcGVueG1sZm9ybWF0cy1vZmZpY2Vkb2N1bWVudC5zcHJlYWRzaGVldG1sLnNoZWV0JyxcbiAgUExBSU4gPSAndGV4dC9wbGFpbidcbn0iLCJpbXBvcnQgeyBEb21vRGF0YUZvcm1hdHMsIERhdGFGb3JtYXRzIH0gZnJvbSAnLi4vbW9kZWxzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGRvbW9Gb3JtYXRUb1JlcXVlc3RGb3JtYXQoZm9ybWF0OiBEb21vRGF0YUZvcm1hdHMpOiBEYXRhRm9ybWF0cyB7XG4gIHN3aXRjaCAoZm9ybWF0KSB7XG4gICAgY2FzZSAnYXJyYXktb2Ytb2JqZWN0cyc6IHtcbiAgICAgIHJldHVybiBEYXRhRm9ybWF0cy5BUlJBWV9PRl9PQkpFQ1RTO1xuICAgIH1cbiAgICBjYXNlICdhcnJheS1vZi1hcnJheXMnOiB7XG4gICAgICByZXR1cm4gRGF0YUZvcm1hdHMuSlNPTjtcbiAgICB9XG4gICAgY2FzZSAnZXhjZWwnOiB7XG4gICAgICByZXR1cm4gRGF0YUZvcm1hdHMuRVhDRUw7XG4gICAgfVxuICAgIGNhc2UgJ2Nzdic6IHtcbiAgICAgIHJldHVybiBEYXRhRm9ybWF0cy5DU1Y7XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIHJldHVybiBEYXRhRm9ybWF0cy5ERUZBVUxUO1xuICAgIH1cbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==